import socket
import sys
from datetime import datetime

import pyfiglet

banner = pyfiglet.figlet_format("Port Scanner")
print(banner)
target = input("Enter host to scan: ")
try:
    start_port = int(input("Start Port:"))
    end_port = int(input("End Port:"))
except ValueError:
    print("Please enter port digits only")
host = socket.gethostbyname(target)
print(f"target: {target}")
print(f"host: {host}")



def check_port(host, port):
    try:
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.settimeout(1)
        result = sock.connect_ex((host, port))
        if result == 0:
            return "Open", socket.getservbyport(port, "tcp")
        else:
            return "Closed", None
    except socket.error:
        return "Error", None
    finally:
        sock.close()

def scan_ports(host, num_ports= end_port - start_port):
    for port in range(start_port, end_port + 1):
        status,service = check_port(host, port)
        if status == "Open":
            print(f"Port {port}: {status} - Service: {service}")
        else:
            print(f"Port {port}: {status}")

scan_ports(host)